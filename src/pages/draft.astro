---
import Layout from "../layouts/Layout.astro";
import DraftCard from "../components/DraftCard.astro";

const draftCards = [
  {
    year: "2025",
    boardImage: "#", // Replace with actual image URL
    first: { icon: "/trophy.svg", text: "POOPY RAINBOW RAIDERS" },
    second: { icon: "/award.svg", text: "POOPY RAINBOW RAIDERS" },
    last: { icon: "/toilet.svg", text: "BLANK SPACE CADETS" },
  },
  {
    year: "2024",
    boardImage: "#", // Replace with actual image URL
    first: { icon: "/trophy.svg", text: "POOPY RAINBOW RAIDERS" },
    second: { icon: "/award.svg", text: "POOPY RAINBOW RAIDERS" },
    last: { icon: "/toilet.svg", text: "BLANK SPACE CADETS" },
  },
  {
    year: "2023",
    boardImage: "#", // Replace with actual image URL
    first: { icon: "/trophy.svg", text: "POOPY RAINBOW RAIDERS" },
    second: { icon: "/award.svg", text: "POOPY RAINBOW RAIDERS" },
    last: { icon: "/toilet.svg", text: "BLANK SPACE CADETS" },
  },
  {
    year: "2022",
    boardImage: "#", // Replace with actual image URL
    videoLink: "#", // Replace with actual YouTube URL
    first: { icon: "/trophy.svg", text: "POOPY RAINBOW RAIDERS" },
    second: { icon: "/award.svg", text: "POOPY RAINBOW RAIDERS" },
    last: { icon: "/toilet.svg", text: "BLANK SPACE CADETS" },
  },
  {
    year: "2021",
    boardImage: "#", // Replace with actual image URL
    videoLink: "#", // Replace with actual YouTube URL
    first: { icon: "/trophy.svg", text: "POOPY RAINBOW RAIDERS" },
    second: { icon: "/award.svg", text: "POOPY RAINBOW RAIDERS" },
    last: { icon: "/toilet.svg", text: "BLANK SPACE CADETS" },
  },
  {
    year: "2020",
    boardImage: "#", // Replace with actual image URL
    videoLink: "#", // Replace with actual YouTube URL
    first: { icon: "/trophy.svg", text: "POOPY RAINBOW RAIDERS" },
    second: { icon: "/award.svg", text: "POOPY RAINBOW RAIDERS" },
    last: { icon: "/toilet.svg", text: "BLANK SPACE CADETS" },
  },
];
---

<Layout>
  <main class="min-h-screen py-12">
    <section class="max-w-6xl mx-auto px-4 sm:px-4">
      <div
        class="cards-grid grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-8 sm:gap-6 sm:justify-items-center justify-content-center mx-auto"
      >
        {
          draftCards.map((card) => (
            <DraftCard
              year={card.year}
              boardImage={card.boardImage}
              videoLink={card.videoLink}
              first={card.first}
              second={card.second}
              last={card.last}
            />
          ))
        }
      </div>
    </section>
  </main>

  <!-- Shadowbox Modal -->
  <div
    id="shadowbox"
    class="fixed inset-0 bg-black/90 z-50 hidden items-center justify-center"
    onclick="closeShadowbox(event)"
  >
    <div
      class="relative max-w-7xl max-h-[90vh] p-4"
      onclick="event.stopPropagation()"
    >
      <button
        class="absolute top-2 right-2 text-white text-4xl font-bold hover:text-gray-300 z-10"
        onclick="closeShadowbox()"
        aria-label="Close"
      >
        Ã—
      </button>
      <img
        id="shadowbox-image"
        src=""
        alt=""
        class="max-w-full max-h-[90vh] object-contain"
      />
    </div>
  </div>
</Layout>

<style>
  .cards-grid {
    grid-auto-columns: max-content;
    width: fit-content;
    margin-left: auto;
    margin-right: auto;
  }

  @media (min-width: 640px) {
    .cards-grid {
      grid-template-columns: repeat(2, max-content);
    }
  }

  @media (min-width: 768px) {
    .cards-grid {
      grid-template-columns: repeat(3, max-content);
    }
  }

  #shadowbox {
    display: flex;
  }

  #shadowbox.hidden {
    display: none;
  }

  .shadowbox-trigger {
    text-decoration: none;
  }
</style>

<script>
  function openShadowbox(imageUrl: string) {
    const shadowbox = document.getElementById("shadowbox");
    const shadowboxImage = document.getElementById(
      "shadowbox-image"
    ) as HTMLImageElement;
    if (shadowbox && shadowboxImage) {
      shadowboxImage.src = imageUrl;
      shadowbox.classList.remove("hidden");
      document.body.style.overflow = "hidden";
    }
  }

  function closeShadowbox(event?: Event) {
    if (
      event &&
      event.target !== event.currentTarget &&
      (event.target as HTMLElement).id !== "shadowbox"
    ) {
      return;
    }
    const shadowbox = document.getElementById("shadowbox");
    if (shadowbox) {
      shadowbox.classList.add("hidden");
      document.body.style.overflow = "";
    }
  }

  // Handle shadowbox triggers
  document.addEventListener("click", (e) => {
    const target = e.target as HTMLElement;
    if (target.classList.contains("shadowbox-trigger")) {
      e.preventDefault();
      const imageUrl = target.getAttribute("data-image");
      if (imageUrl) {
        openShadowbox(imageUrl);
      }
    }
  });

  // Close on Escape key
  document.addEventListener("keydown", (e) => {
    if (e.key === "Escape") {
      closeShadowbox();
    }
  });
</script>
